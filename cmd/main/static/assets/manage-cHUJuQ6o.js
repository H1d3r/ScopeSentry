import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bjl2qjEM.js";import{d as a,V as t,s as o,e as l,v as s,M as r,B as i,G as n,F as d,r as m,o as c,c as u,w as p,a as f,f as y,z as g,t as b,A as j,C as v,X as _,J as w,l as h,_ as x}from"./index-D9UQcSFE.js";import{a as E,E as C}from"./el-col-CXXou3fy.js";import{E as U}from"./el-upload-LZeOK5Ti.js";import"./el-progress-DiltV8uQ.js";import{E as k,a as S}from"./el-form-ClIvQroC.js";import{E as A}from"./el-tag-kYKN7H0G.js";import{_ as V}from"./Table.vue_vue_type_script_lang-BwmIaq25.js";import{_ as R}from"./Dialog.vue_vue_type_style_index_0_lang-DeqRaDiv.js";import{u as z}from"./useTable-CbxTkDDT.js";import{d as L,a as B,g as D,c as F}from"./index-DRPh3UHe.js";import"./el-card-DCo43hKN.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-CI0yhH6M.js";import"./index-BOy3-hgS.js";import"./castArray-Bow0xsjh.js";import"./el-table-column-Bzxs424x.js";import"./debounce-CgKOJkOb.js";import"./el-checkbox-t7oy-lx0.js";import"./isArrayLikeObject-CT7DS3OS.js";import"./raf-B6O9U2CX.js";import"./el-pagination-C9wpkp8F.js";import"./el-select-Dv9vCEmJ.js";import"./strings-CBvC00KA.js";import"./useInput-DYqoIpgX.js";import"./el-image-viewer-gZ5dQPUY.js";import"./el-empty-CBFdbnl8.js";import"./tsxHelper-Dc2XHH9E.js";import"./el-dropdown-item-C-MClRcm.js";import"./refs-wNcffJKd.js";import"./index-BGn7iVRV.js";import"./el-dialog-Dx-yfAYV.js";import"./index-BRGVtAVt.js";const I={class:"mb-10px"},M={class:"mb-10px"};function N(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!w(e)}const O=x(a({__name:"manage",setup(a){const{t:w}=h(),x={Authorization:`${t().getToken}`},O=o([{field:"selection",type:"selection",width:"55"},{field:"id",hidden:!0},{field:"name",label:w("common.name"),minWidth:40},{field:"category",label:w("common.category"),minWidth:40,formatter:(e,a,t)=>l(A,{type:"success",effect:"light",size:"large"},N(t)?t:{default:()=>[t]})},{field:"size",label:w("common.filesize"),formatter:(e,a,t)=>t+"MB"},{field:"upload",label:w("common.upload"),formatter:(e,a,t)=>{const o=`/api/dictionary/manage/save?id=${e.id}`;return s("div",[s(U,{class:"upload-demo",action:o,headers:x,onSuccess:e=>{200===e.code?r.success("Upload succes"):r.error("Upload failed"),G()},onError:e=>{r.error(`Upload failed: ${e}`)}},(()=>s(i,{type:"warning"},w("common.cover"))))])}},{field:"download",label:w("common.download"),formatter:(e,a,t)=>{let o;return l(d,null,[l(n,{type:"primary",onClick:()=>se(e.id,e.name)},N(o=w("common.download"))?o:{default:()=>[o]})])}},{field:"action",label:w("tableDemo.action"),minWidth:40,formatter:(e,a,t)=>{let o;return l(d,null,[l(n,{type:"danger",onClick:()=>Z(e)},N(o=w("common.delete"))?o:{default:()=>[o]})])}}]),{tableRegister:T,tableState:W,tableMethods:$}=z({fetchDataApi:async()=>({list:(await D()).data.list})}),{loading:H,dataList:q}=W,{getList:G,getElTableExpose:J}=$;function K(){return{background:"var(--el-fill-color-light)"}}const P=m(!1),X=m({name:"",category:""}),Y=m(!1),Z=async e=>{if(window.confirm("Are you sure you want to delete this data?")){Y.value=!0;try{await L([e.id]);Y.value=!1,G()}catch(a){Y.value=!1,G()}}},Q=m([]),ee=async()=>{window.confirm("Are you sure you want to delete the selected data?")&&await(async()=>{const e=await J(),a=(null==e?void 0:e.getSelectionRows())||[];Q.value=a.map((e=>e.id)),Y.value=!0;try{await L(Q.value),Y.value=!1,G()}catch(t){Y.value=!1,G()}})()},ae=m();async function te(e){try{const a=e.file,t=new FormData;t.append("file",a),t.append("name",X.value.name),t.append("category",X.value.category),await F(t),G(),P.value=!1,r.success("Upload success")}catch(a){r.error(`Upload failed: ${a}`)}}async function oe(){ae.value.submit()}const le=async()=>{X.value.name="",P.value=!0},se=async(e,a)=>{const t=await B(e),o=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.href=o,l.setAttribute("download",a),document.body.appendChild(l),l.click(),document.body.removeChild(l)};return(a,t)=>(c(),u(d,null,[l(f(e),null,{default:p((()=>[l(f(E),{gutter:60},{default:p((()=>[l(f(C),{span:1},{default:p((()=>[y("div",I,[l(f(i),{type:"primary",onClick:le},{default:p((()=>[g(b(f(w)("common.new")),1)])),_:1})])])),_:1}),l(f(C),{span:1},{default:p((()=>[y("div",M,[l(f(n),{type:"danger",loading:Y.value,onClick:ee},{default:p((()=>[g(b(f(w)("common.delete")),1)])),_:1},8,["loading"])])])),_:1})])),_:1}),l(f(V),{columns:O,data:f(q),stripe:"",border:!0,loading:f(H),resizable:!0,onRegister:f(T),headerCellStyle:K,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["columns","data","loading","onRegister"])])),_:1}),l(f(R),{modelValue:P.value,"onUpdate:modelValue":t[2]||(t[2]=e=>P.value=e),title:f(w)("common.new"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"},maxHeight:430},{default:p((()=>[l(f(k),{model:X.value,"label-width":"120px",class:"upload-form"},{default:p((()=>[l(f(S),{label:f(w)("common.name")},{default:p((()=>[l(f(j),{modelValue:X.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>X.value.name=e),placeholder:"Enter name"},null,8,["modelValue"])])),_:1},8,["label"]),l(f(S),{label:f(w)("common.category")},{default:p((()=>[l(f(j),{modelValue:X.value.category,"onUpdate:modelValue":t[1]||(t[1]=e=>X.value.category=e),placeholder:"Enter category"},null,8,["modelValue"])])),_:1},8,["label"]),l(f(S),{label:""},{default:p((()=>[l(f(U),{class:"upload-demo",drag:"",ref_key:"upload",ref:ae,"auto-upload":!1,limit:1,httpRequest:te},{default:p((()=>[l(f(v),{class:"avatar-uploader-icon"},{default:p((()=>[l(f(_))])),_:1})])),_:1},512)])),_:1}),l(f(S),null,{default:p((()=>[l(f(i),{type:"primary",onClick:oe},{default:p((()=>[g("Submit")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64))}}),[["__scopeId","data-v-a03cd13e"]]);export{O as default};
