import{d as e,dG as a,r as t,H as n,a9 as i,x as o,o as s,c as r,f as l,e as p,w as d,z as c,t as u,a as g,B as m,l as f,_ as v}from"./index-D9UQcSFE.js";import{r as y,a as _}from"./index-BRGVtAVt.js";import{e as h}from"./toggleHighContrast-DDw6qYfv.js";const b=(e,a,t)=>y.post({url:"/api/fingerprint/data",data:{search:e,pageIndex:a,pageSize:t}}),C=e=>y.post({url:"/api/fingerprint/delete",data:{ids:e}}),j=()=>y.get({url:"/api/fingerprint/version"}),D=e=>_.post("https://api.scope-sentry.top/api/common/finger/count-by-update-time",{updateTime:e},{headers:{"Content-Type":"application/json"}}).then((e=>e.data)),k=e=>_.post("https://api.scope-sentry.top/api/common/finger/query-by-update-time",{updateTime:e},{headers:{"Content-Type":"application/json"}}).then((e=>e.data)),F=e=>y.post({url:"/api/fingerprint/batch-add",data:{items:e}}),V={class:"fingerprint-detail-container"},w={class:"editor-wrapper"},x={class:"action-bar"},L='fingerprint:\n  name: \n  category: \n  parent_category: \n  company: \n  tags:\n    - "demo"\n  rules:\n  - logic: AND\n    conditions:\n    - location: body\n      match_type: contains\n      pattern: "demo"\n',T=v(e({__name:"Detail",props:{closeDialog:{type:Function},getList:{type:Function},fingerprintForm:{}},setup(e){const{t:v}=f(),_=e,{fingerprintForm:b}=a(_),C=t({...b.value}),j=t(null);let D=null;n((()=>{if(j.value){let e=C.value.content||"";C.value.id||e.trim()||(e=L,C.value.content=e),D=h.create(j.value,{value:e,language:"yaml",theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,lineNumbers:"on",wordWrap:"on"}),D.onDidChangeModelContent((()=>{const e=(null==D?void 0:D.getValue())||"";C.value.content=e}))}})),i((()=>[_.fingerprintForm.content,_.fingerprintForm.id]),(([e,a])=>{if(D)if(a||e&&e.trim())e!==D.getValue()&&(D.setValue(e||""),C.value.content=e||"");else{const e=L;D.getValue()!==e&&(D.setValue(e),C.value.content=e)}})),o((()=>{D&&D.dispose()}));const k=t(!1),F=async()=>{k.value=!0;try{const e=(null==D?void 0:D.getValue())||"";if(!e.trim())return void(k.value=!1);let a;a=""!=C.value.id?await((e,a)=>y.post({url:"/api/fingerprint/update",data:{id:e,content:a}}))(C.value.id,e):await(e=>y.post({url:"/api/fingerprint/add",data:{content:e}}))(e),200===a.code&&(_.getList(),_.closeDialog())}finally{k.value=!1}};return(e,a)=>(s(),r("div",V,[l("div",w,[l("div",{ref_key:"editorContainer",ref:j,class:"yaml-editor"},null,512)]),l("div",x,[p(g(m),{onClick:_.closeDialog},{default:d((()=>[c(u(g(v)("common.cancel")||"取消"),1)])),_:1},8,["onClick"]),p(g(m),{type:"primary",onClick:F,loading:k.value},{default:d((()=>[c(u(g(v)("task.save")||"保存"),1)])),_:1},8,["loading"])])]))}}),[["__scopeId","data-v-58158ce0"]]),z=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}));export{T as D,j as a,D as b,k as c,C as d,F as e,z as f,b as g};
