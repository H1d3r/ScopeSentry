import{a1 as e,ds as t,dM as a,d as l,bj as i,aa as n,r as o,N as s,o as c,i as u,w as d,R as m,f as r,n as p,a as f,C as v,aL as x,j as b,c as _,ab as w,z as g,t as h,F as y,e as V,ai as S,h as k,ac as U,dN as I,aj as R,s as N,y as A,B as j,l as T,_ as E}from"./index-D9UQcSFE.js";import{E as M,a as B}from"./el-col-CXXou3fy.js";import{a as C,E as D}from"./el-form-ClIvQroC.js";import{E as P}from"./el-switch-B9n_0JFR.js";import{E as $}from"./el-input-number-D_WyPwo4.js";import{E as z}from"./el-card-DCo43hKN.js";import{k as F,l as L}from"./index-ChazuCmn.js";import"./castArray-Bow0xsjh.js";import"./index-BRGVtAVt.js";const H=e({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:t(a),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:["light","dark"],default:"light"}}),O={close:e=>e instanceof MouseEvent},q=l({name:"ElAlert"});const G=R(U(l({...q,props:H,emits:O,setup(e,{emit:t}){const l=e,{Close:U}=I,R=i(),N=n("alert"),A=o(!0),j=s((()=>a[l.type])),T=s((()=>[N.e("icon"),{[N.is("big")]:!!l.description||!!R.default}])),E=s((()=>({"with-description":l.description||R.default}))),M=e=>{A.value=!1,t("close",e)};return(e,t)=>(c(),u(k,{name:f(N).b("fade"),persisted:""},{default:d((()=>[m(r("div",{class:p([f(N).b(),f(N).m(e.type),f(N).is("center",e.center),f(N).is(e.effect)]),role:"alert"},[e.showIcon&&f(j)?(c(),u(f(v),{key:0,class:p(f(T))},{default:d((()=>[(c(),u(x(f(j))))])),_:1},8,["class"])):b("v-if",!0),r("div",{class:p(f(N).e("content"))},[e.title||e.$slots.title?(c(),_("span",{key:0,class:p([f(N).e("title"),f(E)])},[w(e.$slots,"title",{},(()=>[g(h(e.title),1)]))],2)):b("v-if",!0),e.$slots.default||e.description?(c(),_("p",{key:1,class:p(f(N).e("description"))},[w(e.$slots,"default",{},(()=>[g(h(e.description),1)]))],2)):b("v-if",!0),e.closable?(c(),_(y,{key:2},[e.closeText?(c(),_("div",{key:0,class:p([f(N).e("close-btn"),f(N).is("customed")]),onClick:M},h(e.closeText),3)):(c(),u(f(v),{key:1,class:p(f(N).e("close-btn")),onClick:M},{default:d((()=>[V(f(U))])),_:1},8,["class"]))],64)):b("v-if",!0)],2)],2),[[S,A.value]])])),_:3},8,["name"]))}}),[["__file","alert.vue"]])),J={style:{"max-width":"600px",margin:"20px 0 0"}},K=E(l({__name:"Deduplication",setup(e){const{t:t}=T(),a=N({asset:!1,subdomain:!0,SubdomainTakerResult:!0,UrlScan:!0,crawler:!0,SensitiveResult:!0,DirScanResult:!0,vulnerability:!1,PageMonitoring:!0,hour:3,flag:!1,runNow:!1});(async()=>{const e=await L();Object.assign(a,e.data),l.value=e.data.next_run_time})();const l=o(""),i=o(!1);return(e,n)=>{const o=A("ElText");return c(),u(f(z),{shadow:"never",class:"mb-20px"},{header:d((()=>[V(f(B),null,{default:d((()=>[V(f(M),{span:3,style:{height:"100%"}},{default:d((()=>[r("span",null,h(f(t)("configuration.duplicationconfiguration")),1)])),_:1})])),_:1})])),default:d((()=>[r("div",J,[V(f(G),{type:"info",closable:!1},{default:d((()=>[r("p",null,h(f(t)("task.nextTime"))+": "+h(l.value),1)])),_:1})]),V(f(D),{model:a,"label-width":"auto","status-icon":"",ref:"ruleFormRef",style:{position:"relative",top:"1rem"}},{default:d((()=>[V(f(B),null,{default:d((()=>[V(f(M),{span:3},{default:d((()=>[V(f(C),{label:f(t)("configuration.deduplicationFlag")},{default:d((()=>[V(f(P),{modelValue:a.flag,"onUpdate:modelValue":n[0]||(n[0]=e=>a.flag=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),a.flag?(c(),u(f(M),{key:0,span:3},{default:d((()=>[V(f(C),{label:f(t)("configuration.runNowOne")},{default:d((()=>[V(f(P),{modelValue:a.runNow,"onUpdate:modelValue":n[1]||(n[1]=e=>a.runNow=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})):b("",!0),a.flag?(c(),u(f(M),{key:1,span:5},{default:d((()=>[V(f(C),{label:f(t)("configuration.deduplicationHour"),prop:"type"},{default:d((()=>[V(f($),{modelValue:a.hour,"onUpdate:modelValue":n[2]||(n[2]=e=>a.hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),V(o,{style:{position:"relative",left:"16px"}},{default:d((()=>[g("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):b("",!0)])),_:1}),a.flag?(c(),u(f(B),{key:0},{default:d((()=>[V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("asset.assetName")},{default:d((()=>[V(f(P),{modelValue:a.asset,"onUpdate:modelValue":n[3]||(n[3]=e=>a.asset=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("subdomain.subdomainName")},{default:d((()=>[V(f(P),{modelValue:a.subdomain,"onUpdate:modelValue":n[4]||(n[4]=e=>a.subdomain=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("task.subdomainTakeover")},{default:d((()=>[V(f(P),{modelValue:a.SubdomainTakerResult,"onUpdate:modelValue":n[5]||(n[5]=e=>a.SubdomainTakerResult=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1})):b("",!0),a.flag?(c(),u(f(B),{key:1},{default:d((()=>[V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("URL.URLName")},{default:d((()=>[V(f(P),{modelValue:a.UrlScan,"onUpdate:modelValue":n[6]||(n[6]=e=>a.UrlScan=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("crawler.crawlerName")},{default:d((()=>[V(f(P),{modelValue:a.crawler,"onUpdate:modelValue":n[7]||(n[7]=e=>a.crawler=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("sensitiveInformation.sensitiveInformationName")},{default:d((()=>[V(f(P),{modelValue:a.SensitiveResult,"onUpdate:modelValue":n[8]||(n[8]=e=>a.SensitiveResult=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1})):b("",!0),a.flag?(c(),u(f(B),{key:2},{default:d((()=>[V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("dirScan.dirScanName")},{default:d((()=>[V(f(P),{modelValue:a.DirScanResult,"onUpdate:modelValue":n[9]||(n[9]=e=>a.DirScanResult=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("vulnerability.vulnerabilityName")},{default:d((()=>[V(f(P),{modelValue:a.vulnerability,"onUpdate:modelValue":n[10]||(n[10]=e=>a.vulnerability=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),V(f(M),{span:5},{default:d((()=>[V(f(C),{label:f(t)("PageMonitoring.pageMonitoringName")},{default:d((()=>[V(f(P),{modelValue:a.PageMonitoring,"onUpdate:modelValue":n[11]||(n[11]=e=>a.PageMonitoring=e),"inline-prompt":"","active-text":f(t)("common.switchAction"),"inactive-text":f(t)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1})):b("",!0),V(f(B),null,{default:d((()=>[V(f(M),{span:2,offset:8},{default:d((()=>[V(f(C),null,{default:d((()=>[V(f(j),{type:"primary",onClick:n[12]||(n[12]=e=>(async()=>{i.value=!0,await F(a.asset,a.subdomain,a.SubdomainTakerResult,a.UrlScan,a.crawler,a.SensitiveResult,a.DirScanResult,a.vulnerability,a.PageMonitoring,a.hour,a.flag,a.runNow),i.value=!1})()),loading:i.value},{default:d((()=>[g(h(f(t)("common.submit")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})}}}),[["__scopeId","data-v-00f95b42"]]);export{K as default};
