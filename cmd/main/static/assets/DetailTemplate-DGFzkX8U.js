import{a1 as e,a2 as a,a3 as l,bp as t,r as n,aT as o,a9 as d,a0 as r,N as s,aV as i,b8 as u,bt as c,d as p,ad as f,aa as h,v as m,cu as v,o as y,c as g,f as k,a as b,i as C,w as x,aL as N,n as E,ah as V,C as _,j as w,e as S,aK as K,ac as L,bj as j,O as D,bs as A,aD as P,t as $,aj as B,s as M,A as U,F as T,S as F,B as H,z as I,X as O,l as z,M as R,cy as J,_ as W}from"./index-D9UQcSFE.js";import"./el-tooltip-l0sNRNKZ.js";import{E as Y}from"./el-popper-CI0yhH6M.js";import{E as q}from"./el-card-DCo43hKN.js";import{E as Q}from"./el-switch-B9n_0JFR.js";import{a as X,E as G}from"./el-form-ClIvQroC.js";import{a as Z,E as ee}from"./el-col-CXXou3fy.js";import"./el-tag-kYKN7H0G.js";import"./el-virtual-list-x2q1m_0t.js";import{F as ae,E as le}from"./el-select-v2-gRo57qYg.js";/* empty css                */import{E as te}from"./el-checkbox-t7oy-lx0.js";import{E as ne,b as oe}from"./el-select-Dv9vCEmJ.js";import{E as de}from"./el-drawer-bw6GB9YA.js";import{_ as re}from"./Dialog.vue_vue_type_style_index_0_lang-DeqRaDiv.js";import{d as se}from"./index-BdT7lvrf.js";import{c as ie}from"./index-7Bo_TG81.js";import{o as ue,p as ce}from"./index-BoLqEwEd.js";import{g as pe,e as fe}from"./index-DRPh3UHe.js";import"./castArray-Bow0xsjh.js";import"./raf-B6O9U2CX.js";import"./useInput-DYqoIpgX.js";import"./index-BOy3-hgS.js";import"./debounce-CgKOJkOb.js";import"./strings-CBvC00KA.js";import"./el-dialog-Dx-yfAYV.js";import"./refs-wNcffJKd.js";import"./index-BRGVtAVt.js";const he=Symbol(),me={key:-1,level:-1,data:{}};var ve=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e))(ve||{}),ye=(e=>(e.ADD="add",e.DELETE="delete",e))(ye||{});const ge={type:Number,default:26},ke=e({data:{type:a(Array),default:()=>l([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:a(Object),default:()=>l({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:a(Array),default:()=>l([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:a(Array),default:()=>l([])},indent:{type:Number,default:16},itemSize:ge,icon:{type:t},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:a([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:a(Function)},perfMode:{type:Boolean,default:!0}}),be=e({node:{type:a(Object),default:()=>l(me)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:ge}),Ce=e({node:{type:a(Object),required:!0}}),xe="node-click",Ne="node-expand",Ee="node-collapse",Ve="current-change",_e="check",we="check-change",Se="node-contextmenu",Ke={[xe]:(e,a,l)=>e&&a&&l,[Ne]:(e,a)=>e&&a,[Ee]:(e,a)=>e&&a,[Ve]:(e,a)=>e&&a,[_e]:(e,a)=>e&&a,[we]:(e,a)=>e&&"boolean"==typeof a,[Se]:(e,a,l)=>e&&a&&l};function Le(e,a){const l=n(new Set(e.defaultExpandedKeys)),t=n(),p=u();d((()=>e.currentNodeKey),(e=>{t.value=e}),{immediate:!0}),d((()=>e.data),(e=>{T(e)}),{immediate:!0});const{isIndeterminate:f,isChecked:h,toggleCheckbox:m,getCheckedKeys:v,getCheckedNodes:y,getHalfCheckedKeys:g,getHalfCheckedNodes:k,setChecked:b,setCheckedKeys:C}=function(e,a){const l=n(new Set),t=n(new Set),{emit:s}=o();d([()=>a.value,()=>e.defaultCheckedKeys],(()=>r((()=>{m(e.defaultCheckedKeys)}))),{immediate:!0});const i=()=>{if(!a.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:n,maxLevel:o}=a.value,d=l.value,r=new Set;for(let e=o-1;e>=1;--e){const a=n.get(e);a&&a.forEach((e=>{const a=e.children;if(a){let l=!0,t=!1;for(const e of a){const a=e.key;if(d.has(a))t=!0;else{if(r.has(a)){l=!1,t=!0;break}l=!1}}l?d.add(e.key):t?(r.add(e.key),d.delete(e.key)):(d.delete(e.key),r.delete(e.key))}}))}t.value=r},u=e=>l.value.has(e.key),c=(a,t,n=!0)=>{const o=l.value,d=(a,l)=>{o[l?ye.ADD:ye.DELETE](a.key);const t=a.children;!e.checkStrictly&&t&&t.forEach((e=>{e.disabled||d(e,l)}))};d(a,t),i(),n&&p(a,t)},p=(e,a)=>{const{checkedNodes:l,checkedKeys:t}=f(),{halfCheckedNodes:n,halfCheckedKeys:o}=h();s(_e,e.data,{checkedKeys:t,checkedNodes:l,halfCheckedKeys:o,halfCheckedNodes:n}),s(we,e.data,a)};function f(t=!1){const n=[],o=[];if((null==a?void 0:a.value)&&e.showCheckbox){const{treeNodeMap:e}=a.value;l.value.forEach((a=>{const l=e.get(a);l&&(!t||t&&l.isLeaf)&&(o.push(a),n.push(l.data))}))}return{checkedKeys:o,checkedNodes:n}}function h(){const l=[],n=[];if((null==a?void 0:a.value)&&e.showCheckbox){const{treeNodeMap:e}=a.value;t.value.forEach((a=>{const t=e.get(a);t&&(n.push(a),l.push(t.data))}))}return{halfCheckedNodes:l,halfCheckedKeys:n}}function m(l){if(null==a?void 0:a.value){const{treeNodeMap:t}=a.value;if(e.showCheckbox&&t&&l)for(const e of l){const a=t.get(e);a&&!u(a)&&c(a,!0,!1)}}}return{updateCheckedKeys:i,toggleCheckbox:c,isChecked:u,isIndeterminate:e=>t.value.has(e.key),getCheckedKeys:function(e=!1){return f(e).checkedKeys},getCheckedNodes:function(e=!1){return f(e).checkedNodes},getHalfCheckedKeys:function(){return h().halfCheckedKeys},getHalfCheckedNodes:function(){return h().halfCheckedNodes},setChecked:function(l,t){if((null==a?void 0:a.value)&&e.showCheckbox){const e=a.value.treeNodeMap.get(l);e&&c(e,t,!1)}},setCheckedKeys:function(e){l.value.clear(),t.value.clear(),r((()=>{m(e)}))}}}(e,p),{doFilter:x,hiddenNodeKeySet:N,isForceHiddenExpandIcon:E}=function(e,a){const l=n(new Set([])),t=n(new Set([])),o=s((()=>i(e.filterMethod)));return{hiddenExpandIconKeySet:t,hiddenNodeKeySet:l,doFilter:function(n){var d;if(!o.value)return;const r=new Set,s=t.value,i=l.value,u=[],c=(null==(d=a.value)?void 0:d.treeNodes)||[],p=e.filterMethod;return i.clear(),function e(a){a.forEach((a=>{u.push(a),(null==p?void 0:p(n,a.data))?u.forEach((e=>{r.add(e.key)})):a.isLeaf&&i.add(a.key);const l=a.children;if(l&&e(l),!a.isLeaf)if(r.has(a.key)){if(l){let e=!0;for(const a of l)if(!i.has(a.key)){e=!1;break}e?s.add(a.key):s.delete(a.key)}}else i.add(a.key);u.pop()}))}(c),r},isForceHiddenExpandIcon:function(e){return t.value.has(e.key)}}}(e,p),V=s((()=>{var a;return(null==(a=e.props)?void 0:a.value)||ve.KEY})),_=s((()=>{var a;return(null==(a=e.props)?void 0:a.children)||ve.CHILDREN})),w=s((()=>{var a;return(null==(a=e.props)?void 0:a.disabled)||ve.DISABLED})),S=s((()=>{var a;return(null==(a=e.props)?void 0:a.label)||ve.LABEL})),K=s((()=>{const e=l.value,a=N.value,t=[],n=p.value&&p.value.treeNodes||[];return function(){const l=[];for(let e=n.length-1;e>=0;--e)l.push(n[e]);for(;l.length;){const n=l.pop();if(n&&(a.has(n.key)||t.push(n),e.has(n.key))){const e=n.children;if(e){for(let a=e.length-1;a>=0;--a)l.push(e[a])}}}}(),t})),L=s((()=>K.value.length>0));function j(e){return e[_.value]}function D(e){return e?e[V.value]:""}function A(e){return e[w.value]}function P(e){return e[S.value]}function $(e){l.value.has(e.key)?M(e):B(e)}function B(t){const n=l.value;if(p.value&&e.accordion){const{treeNodeMap:e}=p.value;n.forEach((a=>{const l=e.get(a);t&&t.level===(null==l?void 0:l.level)&&n.delete(a)}))}n.add(t.key),a(Ne,t.data,t)}function M(e){l.value.delete(e.key),a(Ee,e.data,e)}function U(e){const a=t.value;return void 0!==a&&a===e.key}function T(e){r((()=>p.value=function(e){const a=new Map,l=new Map;let t=1;const n=function e(n,o=1,d){var r;const s=[];for(const t of n){const n=D(t),i={level:o,key:n,data:t};i.label=P(t),i.parent=d;const u=j(t);i.disabled=A(t),i.isLeaf=!u||0===u.length,u&&u.length&&(i.children=e(u,o+1,i)),s.push(i),a.set(n,i),l.has(o)||l.set(o,[]),null==(r=l.get(o))||r.push(i)}return o>t&&(t=o),s}(e);return{treeNodeMap:a,levelTreeNodeMap:l,maxLevel:t,treeNodes:n}}(e)))}return{tree:p,flattenTree:K,isNotEmpty:L,getKey:D,getChildren:j,toggleExpand:$,toggleCheckbox:m,isExpanded:function(e){return l.value.has(e.key)},isChecked:h,isIndeterminate:f,isDisabled:function(e){return!!e.disabled},isCurrent:U,isForceHiddenExpandIcon:E,handleNodeClick:function(l,n){a(xe,l.data,l,n),function(e){U(e)||(t.value=e.key,a(Ve,e.data,e))}(l),e.expandOnClickNode&&$(l),e.showCheckbox&&e.checkOnClickNode&&!l.disabled&&m(l,!h(l),!0)},handleNodeCheck:function(e,a){m(e,a)},getCurrentNode:function(){var e,a;if(t.value)return null==(a=null==(e=p.value)?void 0:e.treeNodeMap.get(t.value))?void 0:a.data},getCurrentKey:function(){return t.value},setCurrentKey:function(e){t.value=e},getCheckedKeys:v,getCheckedNodes:y,getHalfCheckedKeys:g,getHalfCheckedNodes:k,setChecked:b,setCheckedKeys:C,filter:function(e){const a=x(e);a&&(l.value=a)},setData:T,getNode:function(e){var a;const l=c(e)?D(e):e;return null==(a=p.value)?void 0:a.treeNodeMap.get(l)},expandNode:B,collapseNode:M,setExpandedKeys:function(e){l.value=new Set(e)}}}var je=p({name:"ElTreeNodeContent",props:Ce,setup(e){const a=f(he),l=h("tree");return()=>{const t=e.node,{data:n}=t;return(null==a?void 0:a.ctx.slots.default)?a.ctx.slots.default({node:t,data:n}):m("span",{class:l.be("node","label")},[null==t?void 0:t.label])}}});const De=["aria-expanded","aria-disabled","aria-checked","data-key","onClick"],Ae=p({name:"ElTreeNode"});var Pe=L(p({...Ae,props:be,emits:{click:(e,a)=>!(!e||!a),toggle:e=>!!e,check:(e,a)=>e&&"boolean"==typeof a},setup(e,{emit:a}){const l=e,t=f(he),n=h("tree"),o=s((()=>{var e;return null!=(e=null==t?void 0:t.props.indent)?e:16})),d=s((()=>{var e;return null!=(e=null==t?void 0:t.props.icon)?e:v})),r=e=>{a("click",l.node,e)},i=()=>{a("toggle",l.node)},u=e=>{a("check",l.node,e)},c=e=>{var a,n,o,d;(null==(o=null==(n=null==(a=null==t?void 0:t.instance)?void 0:a.vnode)?void 0:n.props)?void 0:o.onNodeContextmenu)&&(e.stopPropagation(),e.preventDefault()),null==t||t.ctx.emit(Se,e,null==(d=l.node)?void 0:d.data,l.node)};return(e,a)=>{var l,t,s;return y(),g("div",{ref:"node$",class:E([b(n).b("node"),b(n).is("expanded",e.expanded),b(n).is("current",e.current),b(n).is("focusable",!e.disabled),b(n).is("checked",!e.disabled&&e.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.disabled,"aria-checked":e.checked,"data-key":null==(l=e.node)?void 0:l.key,onClick:V(r,["stop"]),onContextmenu:c},[k("div",{class:E(b(n).be("node","content")),style:K({paddingLeft:(e.node.level-1)*b(o)+"px",height:e.itemSize+"px"})},[b(d)?(y(),C(b(_),{key:0,class:E([b(n).is("leaf",!!(null==(t=e.node)?void 0:t.isLeaf)),b(n).is("hidden",e.hiddenExpandIcon),{expanded:!(null==(s=e.node)?void 0:s.isLeaf)&&e.expanded},b(n).be("node","expand-icon")]),onClick:V(i,["stop"])},{default:x((()=>[(y(),C(N(b(d))))])),_:1},8,["class","onClick"])):w("v-if",!0),e.showCheckbox?(y(),C(b(te),{key:1,"model-value":e.checked,indeterminate:e.indeterminate,disabled:e.disabled,onChange:u,onClick:a[0]||(a[0]=V((()=>{}),["stop"]))},null,8,["model-value","indeterminate","disabled"])):w("v-if",!0),S(b(je),{node:e.node},null,8,["node"])],6)],42,De)}}}),[["__file","tree-node.vue"]]);const $e=p({name:"ElTreeV2"});const Be=B(L(p({...$e,props:ke,emits:Ke,setup(e,{expose:a,emit:l}){const t=e,n=j(),d=s((()=>t.itemSize));D(he,{ctx:{emit:l,slots:n},props:t,instance:o()}),D(A,void 0);const{t:r}=P(),i=h("tree"),{flattenTree:u,isNotEmpty:c,toggleExpand:p,isExpanded:f,isIndeterminate:m,isChecked:v,isDisabled:N,isCurrent:V,isForceHiddenExpandIcon:_,handleNodeClick:w,handleNodeCheck:S,toggleCheckbox:L,getCurrentNode:B,getCurrentKey:M,setCurrentKey:U,getCheckedKeys:T,getCheckedNodes:F,getHalfCheckedKeys:H,getHalfCheckedNodes:I,setChecked:O,setCheckedKeys:z,filter:R,setData:J,getNode:W,expandNode:Y,collapseNode:q,setExpandedKeys:Q}=Le(t,l);return a({toggleCheckbox:L,getCurrentNode:B,getCurrentKey:M,setCurrentKey:U,getCheckedKeys:T,getCheckedNodes:F,getHalfCheckedKeys:H,getHalfCheckedNodes:I,setChecked:O,setCheckedKeys:z,filter:R,setData:J,getNode:W,expandNode:Y,collapseNode:q,setExpandedKeys:Q}),(e,a)=>{var l;return y(),g("div",{class:E([b(i).b(),{[b(i).m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[b(c)?(y(),C(b(ae),{key:0,"class-name":b(i).b("virtual-list"),data:b(u),total:b(u).length,height:e.height,"item-size":b(d),"perf-mode":e.perfMode},{default:x((({data:a,index:l,style:t})=>[(y(),C(Pe,{key:a[l].key,style:K(t),node:a[l],expanded:b(f)(a[l]),"show-checkbox":e.showCheckbox,checked:b(v)(a[l]),indeterminate:b(m)(a[l]),"item-size":b(d),disabled:b(N)(a[l]),current:b(V)(a[l]),"hidden-expand-icon":b(_)(a[l]),onClick:b(w),onToggle:b(p),onCheck:b(S)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck"]))])),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(y(),g("div",{key:1,class:E(b(i).e("empty-block"))},[k("span",{class:E(b(i).e("empty-text"))},$(null!=(l=e.emptyText)?l:b(r)("el.tree.emptyText")),3)],2))],2)}}}),[["__file","tree.vue"]])),Me={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"20px","border-bottom":"1px solid #f0f2f5","padding-bottom":"15px"}},Ue={style:{display:"flex","align-items":"center",gap:"10px"}},Te={style:{"font-weight":"600","font-size":"16px",color:"#303133"}},Fe={class:"plugins-container"},He={class:"plugin-card-header"},Ie={class:"plugin-title"},Oe={class:"plugin-name-wrapper"},ze=["title"],Re={key:0,class:"plugin-desc"},Je={class:"text-truncate"},We={class:"plugin-card-body"},Ye={style:{display:"flex",gap:"8px","align-items":"flex-start"}},qe={style:{display:"flex","align-items":"flex-start",gap:"8px"}},Qe={style:{"font-weight":"600",color:"#409eff","flex-shrink":"0"}},Xe={style:{color:"#606266","line-height":"1.6"}},Ge={style:{padding:"12px",border:"1px solid #dcdfe6","border-radius":"4px"}},Ze={style:{display:"flex","align-items":"center",gap:"8px"}},ea={key:2,style:{"text-align":"center",padding:"40px",color:"#909399"}},aa={style:{"font-size":"12px",color:"#909399","margin-top":"4px"}},la={style:{"text-align":"right"}},ta=W(p({__name:"DetailTemplate",props:{closeDialog:{type:Function},getList:{type:Function},id:{}},setup(e){const{t:a}=z(),l=e,t=["TargetHandler","SubdomainScan","SubdomainSecurity","PortScanPreparation","PortScan","PortFingerprint","AssetMapping","AssetHandle","URLScan","WebCrawler","URLSecurity","DirScan","VulnerabilityScan","PassiveScan"],o=M({}),s=M({}),i=M({}),u=M({}),c=n([]),p=n([]),f=e=>e&&0!==e.length?e.filter((e=>e&&e.name&&e.type)).map((e=>"dict"===e.type?e.dictCategory&&e.dictName?`-${e.name} {dict.${e.dictCategory}.${e.dictName}}`:null:"port"===e.type?e.portName?`-${e.name} {port.${e.portName}}`:null:void 0!==e.defaultValue&&null!==e.defaultValue&&""!==e.defaultValue?`-${e.name} ${e.defaultValue}`:null)).filter((e=>null!==e)).join(" "):"",h=e=>{if(!e||""===e.trim())return[];const a=e.match(/-(\w+)\s+(\S+)/g);return a?a.map((e=>{const a=e.match(/-(\w+)\s+(.+)/);if(a){const e=a[1],l=a[2];if("true"===l||"false"===l)return{name:e,type:"bool",defaultValue:l};if(l.startsWith("{dict.")){const a=l.match(/{dict\.(.+)\.(.+)}/);if(a)return{name:e,type:"dict",dictCategory:a[1],dictName:a[2]}}if(l.startsWith("{port.")){const a=l.match(/{port\.(.+)}/);if(a)return{name:e,type:"port",portName:a[1]}}return{name:e,type:"string",defaultValue:l}}return null})).filter((e=>null!==e)):[]},m=(e,a)=>{setTimeout((()=>{var l;const t=(null==(l=s[e])?void 0:l[a])||[],n=f(t);i[e]||(i[e]={}),i[e][a]=n}),0)},v=n([]);d((()=>l.id),(async e=>{e?await(async e=>{var a;const l=await ce(e);j.value=l.data.name,v.value=l.data.vullist;for(const n of t){i[n]={},s[n]={};const e=(null==(a=l.data)?void 0:a[n])||[],t=await se(n);o[n]=t.data.list.map((a=>{var t,o,d,r;const u=l.data,c=null==(o=null==(t=u.ParameterLists)?void 0:t[n])?void 0:o[a.hash],p=null==(r=null==(d=u.Parameters)?void 0:d[n])?void 0:r[a.hash];let m=[];if(c)if("string"==typeof c)try{m=JSON.parse(c)}catch(y){m=p&&"string"==typeof p?h(p):a.parameterList?JSON.parse(a.parameterList):[]}else m=Array.isArray(c)?c:p&&"string"==typeof p?h(p):a.parameterList?JSON.parse(a.parameterList):[];else if(p&&"string"==typeof p){const e=h(p);if(a.parameterList)try{m=JSON.parse(a.parameterList).map((a=>{const l=e.find((e=>e.name===a.name));return l?{...a,defaultValue:l.defaultValue,dictCategory:l.dictCategory,dictName:l.dictName,portName:l.portName}:a}))}catch(y){m=e}else m=e}else if(a.parameterList)try{m=JSON.parse(a.parameterList)}catch(y){m=[]}else m=h(a.parameter||"");s[n][a.hash]=m;const v=f(m);return i[n][a.hash]=v,{...a,enabled:e.includes(a.hash)||!1}}))}})(e):await(async()=>{for(const e of t){const a=await se(e);i[e]={},s[e]={},u[e]=[],o[e]=a.data.list.map((a=>{let l=[];if(a.parameterList)try{l=JSON.parse(a.parameterList)}catch(n){l=h(a.parameter||"")}else l=h(a.parameter||"");s[e]||(s[e]={}),s[e][a.hash]=l;const t=f(l);return i[e][a.hash]=t,{...a,enabled:!1}}))}})()}),{immediate:!0});const N=n(!1),_=async()=>{var e,a;N.value=!0;const n={};if(""==j.value)return R.error("name 不能为空"),void(N.value=!1);for(const l of t){const t=o[l].filter((e=>e.enabled));n[l]=t.map((e=>e.hash)),n.Parameters=n.Parameters||{},n.Parameters[l]={},n.ParameterLists=n.ParameterLists||{},n.ParameterLists[l]={};for(const o of t)(null==(e=i[l])?void 0:e[o.hash])&&(n.Parameters[l][o.hash]=i[l][o.hash]),(null==(a=s[l])?void 0:a[o.hash])&&(n.ParameterLists[l][o.hash]=JSON.stringify(s[l][o.hash]))}n.name=j.value,n.vullist=v.value;try{const e=await ue(n,l.id);200===e.code?(R.success("success"),l.closeDialog(),l.getList()):R.error(e.message||"error")}catch(d){R.error("error")}finally{N.value=!1}},L={TargetHandler:"#409EFF",SubdomainScan:"#E6A23C",SubdomainSecurity:"#F56C6C",PortScanPreparation:"#67C23A",PortScan:"#00CED1",AssetMapping:"#8A2BE2",URLScan:"#C71585",WebCrawler:"#FF4500",DirScan:"#20B2AA",VulnerabilityScan:"#DC143C",AssetHandle:"#4682B4",PortFingerprint:"#DAA520",URLSecurity:"#9370DB",PassiveScan:"#5F9EA0"},j=n(""),D=M([]),A=M([]);(async()=>{const e=await ie();e.data.list.length>0&&(A.push({value:"All Poc",label:"All Poc"}),e.data.list.forEach((e=>{A.push({value:e.id,label:e.name})}))),D.push({value:"All Poc",label:"All Poc",children:[]});const a=(e=>{const a=[];return e.forEach((e=>{let l=a;e.tags.forEach((e=>{const a=l.find((a=>a.label===e));if(a)l=a.children;else{const a={value:Math.random().toString(36).substring(2,8),label:e,children:[]};l.push(a),l=a.children}})),l.push({value:e.id,label:e.name,children:[]})})),a})(e.data.list);D.push(...a)})(),(async()=>{try{const e=await pe();200===e.code&&(c.value=e.data.list)}catch(e){}})(),(async()=>{try{const e=await fe("",1,1e3);200===e.code&&(p.value=e.data.list)}catch(e){}})();const P=n(!1),B=async()=>{P.value=!0},W=n(!1),ae=n(""),te=n(""),he=n(""),me=n(""),ve=n("50%"),ye=(e,a,l)=>{var t;ae.value=e,te.value=a,he.value=l;const n=null==(t=o[e])?void 0:t.find((e=>e.hash===a));me.value=(null==n?void 0:n.help)||"",(()=>{const e=window.innerWidth;ve.value=e<768?"90%":e<1024?"60%":"50%"})(),W.value=!0},ge=()=>{W.value=!1,ae.value="",te.value="",he.value="",me.value=""};d(P,(e=>{e&&r((()=>{ke.value&&be(v.value)}))}));const ke=n(null),be=e=>{r((()=>{const a=ke.value;a&&a.setCheckedKeys(e)}))},Ce={value:"value",label:"label",children:"children"},xe=(e,a)=>{const l=e.value;if(!e.children||0===e.children.length){if(a&&!v.value.includes(l))v.value.push(l);else if(!a){const e=v.value.indexOf(l);e>-1&&v.value.splice(e,1)}}else{const l=e=>{e.children&&e.children.length>0&&e.children.forEach((e=>{if(!e.children||0===e.children.length){if(a&&!v.value.includes(e.value))v.value.push(e.value);else if(!a){const a=v.value.indexOf(e.value);a>-1&&v.value.splice(a,1)}}else l(e)}))};l(e)}};return(e,l)=>(y(),g(T,null,[S(b(G),{onSubmit:V(_,["prevent"]),"label-width":"auto"},{default:x((()=>[S(b(X),{label:b(a)("task.templateName")},{default:x((()=>[S(b(U),{modelValue:j.value,"onUpdate:modelValue":l[0]||(l[0]=e=>j.value=e)},null,8,["modelValue"])])),_:1},8,["label"]),(y(),g(T,null,F(t,(e=>k("div",{key:e},[S(b(q),{class:"module-card","body-style":{padding:"20px"},shadow:"always"},{default:x((()=>[k("div",Me,[k("div",Ue,[k("div",{style:K({width:"4px",height:"16px",backgroundColor:L[e],borderRadius:"2px"})},null,4),k("span",Te,$(b(a)(`scanTemplate.${e}`)),1)])]),k("div",Fe,[(y(!0),g(T,null,F(o[e],(t=>(y(),C(b(q),{key:t.hash,class:E(["plugin-card",{"plugin-card-enabled":t.enabled}]),style:K({"--card-accent-color":L[e]}),"body-style":{padding:"0",height:"100%",display:"flex",flexDirection:"column"},shadow:"hover"},{default:x((()=>[k("div",He,[k("div",Ie,[k("div",Oe,[k("span",{class:"plugin-name",title:t.name},$(t.name),9,ze)]),S(b(Y),{placement:"top",effect:"dark",content:t.enabled?b(a)("common.enabled"):b(a)("common.disabled")},{default:x((()=>[S(b(Q),{modelValue:t.enabled,"onUpdate:modelValue":e=>t.enabled=e,class:"plugin-switch",style:{"--el-switch-on-color":"var(--card-accent-color)"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["content"])]),t.introduction?(y(),g("div",Re,[S(b(Y),{placement:"top",effect:"light",content:t.introduction},{default:x((()=>[k("span",Je,$(t.introduction),1)])),_:2},1032,["content"])])):w("",!0)]),k("div",We,[t.enabled&&"ed93b8af6b72fe54a60efdb932cf6fbc"===t.hash?(y(),C(b(X),{key:0,label:b(a)("task.vulList"),prop:"type"},{default:x((()=>[S(b(le),{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=e=>v.value=e),filterable:"",options:A,placeholder:"Please select vul",style:{width:"80%","margin-right":"10px"},multiple:"","collapse-tags":"","collapse-tags-tooltip":"","tag-type":"info","max-collapse-tags":3},null,8,["modelValue","options"]),S(b(H),{type:"primary",onClick:B,loading:N.value},{default:x((()=>[I($(b(a)("common.selectCategory")),1)])),_:1},8,["loading"])])),_:1},8,["label"])):w("",!0),t.enabled?(y(),C(b(X),{key:1,label:b(a)("plugin.parameter")},{default:x((()=>{var l;return[k("div",Ye,[S(b(U),{"model-value":(null==(l=i[e])?void 0:l[t.hash])||"",readonly:"",style:{"background-color":"#f5f5f5",flex:"1"},type:"textarea",rows:2},null,8,["model-value"]),S(b(H),{type:"primary",size:"small",onClick:a=>ye(e,t.hash,t.name)},{default:x((()=>[I($(b(a)("plugin.parameterConfig")),1)])),_:2},1032,["onClick"])])]})),_:2},1032,["label"])):w("",!0)])])),_:2},1032,["class","style"])))),128))])])),_:2},1024)]))),64)),S(b(Z),null,{default:x((()=>[S(b(ee),{span:12,style:{"text-align":"right"}},{default:x((()=>[S(b(H),{type:"primary",onClick:_,loading:N.value},{default:x((()=>[I(" 保存 ")])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1}),S(b(re),{modelValue:P.value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.value=e),title:"POC",center:"",fullscreen:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgba(0, 0, 0, 0.3)"}},{default:x((()=>[S(b(Be),{ref_key:"treeRef",ref:ke,style:{"max-width":"100%"},data:D,props:Ce,"show-checkbox":"",height:600,onCheckChange:xe},null,8,["data"])])),_:1},8,["modelValue"]),S(b(de),{modelValue:W.value,"onUpdate:modelValue":l[9]||(l[9]=e=>W.value=e),title:he.value?`${he.value} - ${b(a)("plugin.parameterConfig")}`:b(a)("plugin.parameterConfig"),size:ve.value,direction:"rtl","close-on-click-modal":!1},{footer:x((()=>[k("div",la,[S(b(H),{onClick:ge},{default:x((()=>[I($(b(a)("common.cancel")),1)])),_:1}),S(b(H),{type:"primary",onClick:ge,style:{"margin-left":"10px"}},{default:x((()=>[I($(b(a)("common.confirmed")),1)])),_:1})])])),default:x((()=>[S(b(G),{"label-width":"100px"},{default:x((()=>{var e,t;return[me.value?(y(),C(b(Z),{key:0,style:{"margin-bottom":"20px"}},{default:x((()=>[S(b(ee),{span:24},{default:x((()=>[S(b(q),{shadow:"never",style:{"background-color":"#f0f9ff",border:"1px solid #b3d8ff"}},{default:x((()=>[k("div",qe,[k("span",Qe,$(b(a)("plugin.help"))+": ",1),k("span",Xe,$(me.value),1)])])),_:1})])),_:1})])),_:1})):w("",!0),(null==(t=null==(e=s[ae.value])?void 0:e[te.value])?void 0:t.length)?(y(),C(b(Z),{key:1,gutter:20},{default:x((()=>{var e;return[(y(!0),g(T,null,F((null==(e=s[ae.value])?void 0:e[te.value])||[],((e,t)=>(y(),C(b(ee),{key:t,span:24,style:{"margin-bottom":"16px"}},{default:x((()=>[k("div",Ge,[S(b(Z),{gutter:10},{default:x((()=>[S(b(ee),{span:24},{default:x((()=>[S(b(X),{prop:`parameterList.${ae.value}.${te.value}.${t}.name`,style:{"margin-bottom":"8px"},label:b(a)("plugin.parameterName")},{default:x((()=>[k("div",Ze,[S(b(U),{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,placeholder:b(a)("plugin.parameterName"),readonly:"string"!==e.type,disabled:"string"!==e.type,style:{flex:"1"},onInput:l[3]||(l[3]=e=>m(ae.value,te.value))},null,8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled"]),S(b(H),{icon:b(J),type:"danger",circle:"",size:"small",onClick:e=>((e,a,l)=>{s[e][a].splice(l,1),m(e,a)})(ae.value,te.value,t)},null,8,["icon","onClick"])])])),_:2},1032,["prop","label"])])),_:2},1024),"string"===e.type||"bool"===e.type?(y(),C(b(ee),{key:0,span:24},{default:x((()=>[S(b(X),{prop:`parameterList.${ae.value}.${te.value}.${t}.defaultValue`,style:{"margin-bottom":"0"},label:b(a)("plugin.defaultValue")},{default:x((()=>["bool"===e.type?(y(),C(b(ne),{key:0,modelValue:e.defaultValue,"onUpdate:modelValue":a=>e.defaultValue=a,placeholder:b(a)("plugin.defaultValue"),onChange:l[4]||(l[4]=e=>m(ae.value,te.value))},{default:x((()=>[S(b(oe),{label:"true",value:"true"}),S(b(oe),{label:"false",value:"false"})])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):(y(),C(b(U),{key:1,modelValue:e.defaultValue,"onUpdate:modelValue":a=>e.defaultValue=a,placeholder:b(a)("plugin.defaultValue"),onInput:l[5]||(l[5]=e=>m(ae.value,te.value))},null,8,["modelValue","onUpdate:modelValue","placeholder"]))])),_:2},1032,["prop","label"])])),_:2},1024)):w("",!0),"dict"===e.type?(y(),g(T,{key:1},[S(b(ee),{span:24,style:{"margin-bottom":"8px"}},{default:x((()=>[S(b(X),{prop:`parameterList.${ae.value}.${te.value}.${t}.dictCategory`,style:{"margin-bottom":"0"},label:b(a)("plugin.category")},{default:x((()=>[S(b(ne),{modelValue:e.dictCategory,"onUpdate:modelValue":a=>e.dictCategory=a,placeholder:b(a)("plugin.category"),filterable:"",onChange:e=>((e,a,l)=>{s[e][a][l].dictName=void 0,m(e,a)})(ae.value,te.value,t)},{default:x((()=>[(y(!0),g(T,null,F(c.value,(e=>(y(),C(b(oe),{key:e.id,label:e.category||e.name,value:e.category||e.name},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","onChange"])])),_:2},1032,["prop","label"])])),_:2},1024),S(b(ee),{span:24},{default:x((()=>[S(b(X),{prop:`parameterList.${ae.value}.${te.value}.${t}.dictName`,style:{"margin-bottom":"0"},label:b(a)("plugin.dictName")},{default:x((()=>[S(b(ne),{modelValue:e.dictName,"onUpdate:modelValue":a=>e.dictName=a,placeholder:b(a)("plugin.dictName"),filterable:"",disabled:!e.dictCategory,onChange:l[6]||(l[6]=e=>m(ae.value,te.value))},{default:x((()=>{return[(y(!0),g(T,null,F((a=e.dictCategory,a?c.value.filter((e=>(e.category||e.name)===a)):[]),(e=>(y(),C(b(oe),{key:e.id,label:e.name,value:e.name},null,8,["label","value"])))),128))];var a})),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])])),_:2},1032,["prop","label"])])),_:2},1024)],64)):w("",!0),"port"===e.type?(y(),C(b(ee),{key:2,span:24},{default:x((()=>[S(b(X),{prop:`parameterList.${ae.value}.${te.value}.${t}.portName`,style:{"margin-bottom":"0"},label:b(a)("plugin.portName")},{default:x((()=>[S(b(ne),{modelValue:e.portName,"onUpdate:modelValue":a=>e.portName=a,placeholder:b(a)("plugin.portName"),filterable:"",onChange:l[7]||(l[7]=e=>m(ae.value,te.value))},{default:x((()=>[(y(!0),g(T,null,F(p.value,(e=>(y(),C(b(oe),{key:e.id,label:e.name,value:e.name},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","label"])])),_:2},1024)):w("",!0)])),_:2},1024)])])),_:2},1024)))),128))]})),_:1})):(y(),g("div",ea,$(b(a)("plugin.noParameters")),1)),S(b(Z),{style:{"margin-top":"20px"}},{default:x((()=>[S(b(ee),{span:24},{default:x((()=>[S(b(H),{icon:b(O),style:{width:"100%"},onClick:l[8]||(l[8]=e=>{return a=ae.value,l=te.value,s[a]||(s[a]={}),s[a][l]||(s[a][l]=[]),s[a][l].push({name:"",type:"string",defaultValue:""}),void m(a,l);var a,l})},{default:x((()=>[I($(b(a)("plugin.addParameter")),1)])),_:1},8,["icon"])])),_:1})])),_:1}),S(b(X),{label:b(a)("plugin.parameter"),style:{"margin-top":"20px"}},{default:x((()=>{var e;return[S(b(U),{"model-value":(null==(e=i[ae.value])?void 0:e[te.value])||"",readonly:"",style:{"background-color":"#f5f5f5"},type:"textarea",rows:3},null,8,["model-value"]),k("div",aa,$(b(a)("plugin.parameterTip")),1)]})),_:1},8,["label"])]})),_:1})])),_:1},8,["modelValue","title","size"])],64))}}),[["__scopeId","data-v-9f96a991"]]);export{ta as default};
